<h1 id="inventory-configuration-for-powervc">Inventory configuration for PowerVC</h1>

<h2 id="base-configuration">Base configuration</h2>
<ol>
  <li>Click <code class="highlighter-rouge">Resources</code> -&gt; <code class="highlighter-rouge">Inventories</code></li>
  <li>Click <code class="highlighter-rouge">Add</code> -&gt; <code class="highlighter-rouge">Add inventory</code></li>
  <li>Enter the following parameters
    <ul>
      <li><strong>Name</strong>: <code class="highlighter-rouge">SAP Demo</code></li>
      <li><strong>Organization</strong>: <em><code class="highlighter-rouge">Your Organization</code></em></li>
    </ul>
  </li>
  <li>
    <p>Add the following variables:</p>

    <p>```yaml
os_add_auth:
  user_domain_name: Default
os_image_filter: rhel86
os_network: “networkname”
os_network_vnic_type: ‘direct’</p>

    <p>os_availability_zones:
  “Name Of Hostgroup”: “Name Of Hostgroup”
  “hostname”: “:MTMS”</p>

    <h1 id="nfs-share-with-installation-software">NFS Share with installation Software</h1>
    <p>nfs_software_archive_srv: 1.2.3.4:/SapInst  # NFS Server with SAP Software
nfs_software_archive_dir: /sapinst  # local mountpoint
```</p>

    <ul>
      <li><code class="highlighter-rouge">os_add_auth</code> might be required if the Openstack Credential requires for PowerVC requires more parameters than the credential provides</li>
      <li><code class="highlighter-rouge">os_network_vnic_type</code>: Use ‘direct’ for SRIOV and ‘normal’ for SEA</li>
      <li>Log in to IBM PowerVC managemnt to get all the other information
        <ul>
          <li><code class="highlighter-rouge">os_filter_image</code>: Images -&gt; ImageList -&gt; Name</li>
          <li><code class="highlighter-rouge">os_network</code>:  Networks -&gt; Name</li>
          <li><code class="highlighter-rouge">os_availability_zones</code>: Hosts -&gt; Hostgroup and Hostlist -&gt; Hostname -&gt; MTMS</li>
        </ul>
      </li>
    </ul>

    <p>This demo assumes that you have downloaded the SAP software installation bundles to a fileserver that can be accessed via NFS from the nodes. 
As the fileserver is used by all host in the inventory you can define it here</p>
  </li>
  <li>Click <code class="highlighter-rouge">Save</code></li>
</ol>

<h2 id="configure-dynamic-inventories">Configure dynamic inventories</h2>

<p>In the just created inventory click on:
1. Click on <code class="highlighter-rouge">Sources</code>
2. Click <code class="highlighter-rouge">Add</code>
3. Enter the following:
   - <strong>Name</strong>: SAP Server
   - <strong>Source</strong>: OpenStack
   - <strong>Credential</strong>: <em>your OpenStack Credential</em>
   - <strong>Host Filter</strong>: <code class="highlighter-rouge">sapdemo.*</code> - I recommend adding a unique prefix to your servers, e.g. <em>sapdemo</em>, in case there are more servers on the environment, and you only want to pick the demo servers<br />
   - <strong>Update Options</strong>: Select Overwrite and Overwrite variables
   - <strong>Source Variables</strong>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  ```yaml
  all_projects: no
  cache: no
  keyed_groups:
    - key: metadata.group
  ```
</code></pre>
</div>

<ol>
  <li>Click <code class="highlighter-rouge">Save</code></li>
</ol>

<p>With that configuration the hosts are added to the inventory with their names. They are reached through their ip addresses (hostvar <code class="highlighter-rouge">ansible_host</code>), They are all added to the group <code class="highlighter-rouge">Hostgroup</code> and to the group that is set during the creation as <code class="highlighter-rouge">metadata.group</code></p>
